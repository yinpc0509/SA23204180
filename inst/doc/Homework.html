<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA23204180 Yin Pengcheng" />

<meta name="date" content="2023-12-04" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">SA23204180 Yin Pengcheng</h4>
<h4 class="date">2023-12-04</h4>



<div id="hw0" class="section level1">
<h1>HW0</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p><span class="math inline">\(R^2\)</span>represents the coefficient of
determination, and it is computed as follows； <span class="math display">\[R^2 = 1 -
\frac{SS_{\text{residual}}}{SS_{\text{total}}}\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>ctl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.17</span>,<span class="fl">5.58</span>,<span class="fl">5.18</span>,<span class="fl">6.11</span>,<span class="fl">4.50</span>,<span class="fl">4.61</span>,<span class="fl">5.17</span>,<span class="fl">4.53</span>,<span class="fl">5.33</span>,<span class="fl">5.14</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>trt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">4.81</span>,<span class="fl">4.17</span>,<span class="fl">4.41</span>,<span class="fl">3.59</span>,<span class="fl">5.87</span>,<span class="fl">3.83</span>,<span class="fl">6.03</span>,<span class="fl">4.89</span>,<span class="fl">4.32</span>,<span class="fl">4.69</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">gl</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Ctl&quot;</span>,<span class="st">&quot;Trt&quot;</span>))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(ctl, trt)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>lm.D9 <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> group)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">summary</span>(lm.D9)<span class="sc">$</span>coef</span></code></pre></div>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept)    5.032  0.2202177 22.85012 9.547128e-15
## groupTrt      -0.371  0.3114349 -1.19126 2.490232e-01</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.0730776</p>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<p>Create a table and a hist using the inner dataset iris.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Petal.Length, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Petal Length Distribution&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Petal Length&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>利用逆变换法复现sample(replace=True)的部分功能</p></li>
<li><p>(3.2) The standard Laplace distribution has density <span class="math inline">\(f(x) = \frac{1}{2}e^{−|x|}, x ∈ R\)</span> .Use
the inverse transform method to generate a random sample of size 1000
from this distribution. Use one of the methods shown in this chapter to
compare the generated sample to the target distribution.</p></li>
<li><p>(3,7) Write a function to generate a random sample of size n from
the Beta(a, b) distribution by the acceptance-rejection method. Generate
a random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p></li>
<li><p>(3.9) The rescaled Epanechnikov kernel [85] is a symmetric
density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),|x|\leq 1\]</span>
Devroye and Gy¨ orfi [71, p. 236] give the following algorithm for
simulation from this distribution. Generate iid U1, U2, U3 ∼ Uniform(−1,
1). If |U3| ≥ |U2| and |U3| ≥ |U1|, deliver U2; otherwise deliver U3.
Write a function to generate random variates from fe, and construct the
histogram density estimate of a large simulated random sample.</p></li>
<li><p>(3.10)Prove that the algorithm given in Exercise 3.9 generates
variates from the density <span class="math inline">\(f_e\)</span></p></li>
</ol>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="question-1" class="section level3">
<h3>Question 1</h3>
<p>函数的具体实现如下：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>my_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">size=</span><span class="fu">length</span>(x),<span class="at">prob=</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x))) {</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="co"># 防止输入概率和不为1 进行”归一化“</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> prob<span class="sc">/</span><span class="fu">sum</span>(prob)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="co"># 逆变换法</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">runif</span>(size)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>}</span></code></pre></div>
<p>分别对不指定概率分布与指定概率分布的情形产生实例验证结果：</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Exp 1</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">my_sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">10000</span>))</span></code></pre></div>
<pre><code>## 
##    1    2    3 
## 3379 3324 3297</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Exp 2</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">my_sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">10000</span>,<span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## 
##    1    2    3 
## 1986 3023 4991</code></pre>
</div>
<div id="question-2" class="section level3">
<h3>Question 2</h3>
<p><span class="math inline">\(f(x) = 0.5e^{−|x|}, x ∈ R\)</span>
,其CDF的逆函数为: <span class="math display">\[F^{-1}(u)=
\begin{equation}
    \left\{
    \begin{aligned}
        ln(2u), u&lt;0.5 \\
        -ln(2(1-u)), u&gt;0.5
    \end{aligned}
    \right.
\end{equation}\]</span></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>u[u<span class="sc">&lt;</span>.<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u[u<span class="sc">&lt;</span>.<span class="dv">5</span>])</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>u[u<span class="sc">&gt;=</span>.<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>u[u<span class="sc">&gt;=</span>.<span class="dv">5</span>])</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">hist</span>(u, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, .<span class="dv">01</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y))<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level3">
<h3>Question 3</h3>
<p>若 <span class="math inline">\(a,b&lt;1\)</span>,当 <span class="math inline">\(x\rightarrow0\quad or\quad
x\rightarrow1\)</span>时 <span class="math inline">\(f(x)\)</span>
会趋近 <span class="math inline">\(\infty\)</span> , 因此假设 <span class="math inline">\(a,b\geq1\)</span>。 可以通过 optimize() 得到<span class="math inline">\(f(x)\)</span>的最大值.记为<span class="math inline">\(x_0\)</span> 选择<span class="math inline">\(g(x)=1,0&lt;x&lt;1\)</span> ， <span class="math inline">\(c=x_0+0.5\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factorial</span>(x<span class="dv">-1</span>))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>}</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>beta_ar <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b){</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  y <span class="ot">=</span> <span class="fu">numeric</span>(n) </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="co">#Beta(a,b)的密度函数</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  fbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">gamma</span>(a<span class="sc">+</span>b)<span class="sc">/</span><span class="fu">gamma</span>(a)<span class="sc">/</span><span class="fu">gamma</span>(b)<span class="sc">*</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>))</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  }</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  x0 <span class="ot">=</span> <span class="fu">as.numeric</span>(<span class="fu">optimize</span>(fbeta,<span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="dv">1</span>, <span class="at">maximum =</span> <span class="cn">TRUE</span>)[[<span class="dv">1</span>]])</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>  <span class="cf">while</span>(k <span class="sc">&lt;</span> n){</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>    <span class="cf">if</span>((<span class="fu">fbeta</span>(x)<span class="sc">/</span>(<span class="fu">fbeta</span>(x0)<span class="sc">+</span><span class="fl">0.5</span>)) <span class="sc">&gt;</span> u){</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>      k <span class="ot">=</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>      y[k] <span class="ot">=</span> x</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>    }</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>  }</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># set.seed(114514)</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">beta_ar</span>(n, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Beta(3,2)&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fu">dbeta</span>(y, <span class="dv">3</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4" class="section level3">
<h3>Question 4</h3>
<p>由所给算法进行实现：</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>DG_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>  <span class="cf">while</span>(k<span class="sc">&lt;</span>n){</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u2) <span class="sc">&amp;</span> <span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u2)){</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>      x[k] <span class="ot">&lt;-</span> u2</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>      x[k] <span class="ot">&lt;-</span> u3</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>    }    </span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  }</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  }</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">DG_simulation</span>(<span class="dv">10000</span>)</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">f</span>(x)<span class="sc">==</span><span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)),<span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-5" class="section level3">
<h3>Question 5</h3>
<p>由对称性，不妨假设所取均为[0,1]上均匀分布。不难理解，该算法所取为次序统计量中非最大元素，n个元素中第k大的次序统计量的密度函数公式为<span class="math display">\[f_k(x)=\frac{n!}{(k-1)!(n-k)!}F(x)^{k−1}(1−F(x))^{n−k}(x)f(x)\]</span>,该算法中<span class="math inline">\(n=3\)</span>, <span class="math display">\[f_1(x)=3(1-x)^2,f_2(x)=6x(1-x), 0\leq
x\leq1\]</span> <span class="math display">\[f(x)=\frac{1}{2}(f_1(x)+f_2(x))=\frac{3}{2}(1-x^2),0\leq
x\leq1\]</span> 再由对称性可知,(3.9)中算法所取变量的密度函数为<span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),|x|\leq 1\]</span></p>
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>• Proof that what value <span class="math inline">\(l/d:=\rho\)</span> should take to minimize the
asymptotic variance of <span class="math inline">\(\hat{\pi}=\frac{2l}{d\hat{p}}\)</span>? (<span class="math inline">\(m\sim B(n,p)\)</span>, using δ method) • Take
three different values of <span class="math inline">\(\rho\)</span>
(<span class="math inline">\(0 ≤ ρ ≤ 1\)</span>, including <span class="math inline">\(ρ_{min}\)</span>) and use Monte Carlo simulation
to verify your answer. (<span class="math inline">\(n = 10^6\)</span>,
Number of repeated simulations <span class="math inline">\(K =
100\)</span>)</p></li>
<li><p>(5.6) In Example 5.7 the control variate approach was illustrated
for Monte Carlo integration of <span class="math display">\[\theta=\int_{0}^{1}e^xdx.\]</span> Now consider
the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1−U})\)</span> and <span class="math inline">\(Var(e^U+e^{1−U})\)</span>, where <span class="math inline">\(U ∼ Uniform(0,1).\)</span> What is the percent
reduction in variance of <span class="math inline">\(\hat\theta\)</span>
that can be achieved using antithetic variates (compared with simple
MC)?</p></li>
<li><p>(5,7) Refer to Exercise 5.6. Use a Monte Carlo simulation to
estimate <span class="math inline">\(\theta\)</span> by the antithetic
variate approach and by the simple Monte Carlo method. Compute an
empirical estimate of the percent reduction in variance using the
antithetic variate. Compare the result with the theoretical value from
Exercise 5.6.</p></li>
</ol>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="question-1-1" class="section level3">
<h3>Question 1</h3>
<p><span class="math inline">\(\hat{p}=\frac{m}{n},m\sim B(n,p)\)</span>
<span class="math display">\[\hat{\pi}=\frac{2l}{d\hat{p}}=\frac{2ln}{dm},p=\frac{2\rho}{\pi}\]</span>
<span class="math display">\[g(\theta)=\frac{1}{\theta},g&#39;(\theta)=-\frac{1}{\theta^2}\]</span></p>
<p><span class="math display">\[Var(\hat{\pi})=4\rho^2\frac{\sigma^2[g&#39;(\theta)]^2}{n}=\frac{\pi^3}{2n^2}\frac{1-2\rho/\pi}{\rho}\]</span></p>
<p>可以看出，渐近方差随<span class="math inline">\(\rho\)</span>的增大而单调递减,由约束规则可知<span class="math inline">\(\rho_{min}=1\)</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> rho){</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  l <span class="ot">&lt;-</span> d<span class="sc">*</span>i</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  pihat <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(m,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    pihat[j] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>  }</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  </span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;When rho = &quot;</span>,i,<span class="st">&quot;Var is &quot;</span>,<span class="fu">var</span>(pihat),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  </span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## When rho =  0.5 Var is  2.654423e-05 
## When rho =  0.8 Var is  9.816017e-06 
## When rho =  1 Var is  7.087332e-06</code></pre>
</div>
<div id="question-2-1" class="section level3">
<h3>Question 2</h3>
<p><span class="math display">\[\begin{aligned}
Cov(e^U,e^{1−U})
&amp; = E(e^Ue^{1-U})-E(e^U)E(e^{1-U})\\
&amp; = e-(e-1)^2\\
&amp; = -e^2+3e-1, \\
Var(e^U+e^{1−U})
&amp; = Cov(e^U+e^{1−U},e^U+e^{1−U})\\
&amp; = Var(e^U)+2Cov(e^U,e^{1−U})+Var(e^{1-U})\\
&amp; = \frac{e^2-1}{2}-(e-1)^2+2(-e^2+3e-1)+\frac{e^2-1}{2}-(e-1)^2\\
&amp; = -3e^2+10e-5.
\end{aligned}\]</span></p>
<p>对于简单估计,<span class="math inline">\(Var(\hat\theta)=\frac{Var(e^U)}{m}\)</span>.<br />
对于对偶估计,<span class="math inline">\(Var(\hat\theta&#39;)=\frac{Var(e^U+e^{1−U})}{2m}\)</span>.<br />
方差减小程度为： <span class="math display">\[100\%*(1-\frac{Var(e^U+e^{1−U})}{2Var(e^U)})=100\%*(1-\frac{-3e^2+10e-5}{-e^2+4e-3})
\approx96.767\%.\]</span></p>
</div>
<div id="question-3-1" class="section level3">
<h3>Question 3</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>MC_anti <span class="ot">&lt;-</span> <span class="cf">function</span>(n, <span class="at">anti=</span><span class="cn">FALSE</span>){</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="cf">if</span>(anti) {</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>    v <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>    <span class="fu">return</span>((<span class="fu">mean</span>(<span class="fu">exp</span>(u))<span class="sc">+</span><span class="fu">mean</span>(<span class="fu">exp</span>(v)))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>    }</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>    v <span class="ot">=</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>    u <span class="ot">=</span> <span class="fu">c</span>(u,v)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(u)))</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>    }</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>v1 <span class="ot">&lt;-</span> v2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a> v1[i] <span class="ot">=</span> <span class="fu">MC_anti</span>(m)</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a> v2[i] <span class="ot">=</span> <span class="fu">MC_anti</span>(m,<span class="cn">TRUE</span>)</span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>}</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>var1 <span class="ot">=</span> <span class="fu">var</span>(v1)</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>var2 <span class="ot">=</span> <span class="fu">var</span>(v2)</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Simple var:&quot;</span>,var1,<span class="st">&quot;</span><span class="sc">\t</span><span class="st"> Anti var: &quot;</span>,var2)</span></code></pre></div>
<pre><code>## Simple var: 2.423449e-05      Anti var:  7.465305e-07</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">The variance reduction is: &quot;</span>,(var1<span class="sc">-</span>var2)<span class="sc">/</span>var1)</span></code></pre></div>
<pre><code>## 
## The variance reduction is:  0.9691955</code></pre>
<p>由结果可以看出，与5.6中理论计算相符。</p>
</div>
</div>
</div>
<div id="hw3" class="section level1">
<h1>HW3</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(Var(\hat{θ}^M) = \frac{1}{Mk}
\sum_{i=1}^k\sigma_i^2+ Var(\theta_I)=Var(\hat{θ}^S)+
Var(\theta_I)\)</span>, where <span class="math inline">\(θi = E[g(U) |
I = i], σi2 = V ar[g(U) | I = i]\)</span> and I takes uniform
distribution over <span class="math inline">\(\{1, . . . , k\}\)</span>.
Proof that if g is a continuous function over <span class="math inline">\((a, b)\)</span>, then <span class="math inline">\(Var(\hat{θ}^S)/V ar(\hat{θ}^M) → 0\)</span> as
<span class="math inline">\(b_i − a_i → 0\)</span> for all <span class="math inline">\(i = 1, . . . , k\)</span>.</p></li>
<li><p>(5.13) Find two importance functions f1 and f2 that are supported
on (1, ∞) and are ‘close’ to <span class="math inline">\(g(x) =
\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}, x &gt; 1\)</span>. Which of your two
importance functions should produce the smaller variance in estimating
<span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}dx\)</span> by importance sampling?
Explain.?</p></li>
<li><p>(5,14) Obtain a Monte Carlo estimate of <span class="math inline">\(\int_1^\infty
\frac{x^2}{\sqrt{2\pi}}e^{−x^2/2}dx\)</span> by importance
sampling.</p></li>
<li><p>(5.15) Obtain the stratified importance sampling estimate in
Example 5.13 and compare it with the result of Example 5.10.</p></li>
<li><p>(6.5) Suppose a 95% symmetric t-interval is applied to estimate a
mean, but the sample data are non-normal. Then the probability that the
confidence interval covers the mean is not necessarily equal to 0.95.
Use a Monte Carlo experiment to estimate the coverage probability of the
t-interval for random samples of <span class="math inline">\(χ^2(2)\)</span> data with sample size n = 20.
Compare your t-interval results with the simulation results in Example
6.4. (The t-interval should be more robust to departures from normality
than the interval for variance.)</p></li>
<li><p>(6.A) Use Monte Carlo simulation to investigate whether the
empirical Type I error rate of the t-test is approximately equal to the
nominal significance level <span class="math inline">\(α\)</span>, when
the sampled population is non-normal. The t-test is robust to mild
departures from normality. Discuss the simulation results for the cases
where the sampled population is (i) <span class="math inline">\(χ^2(1)\)</span>, (ii) Uniform(0,2), and (iii)
Exponential(rate=1). In each case, test <span class="math inline">\(H0 :
µ = µ0 ~vs~ H0 : µ ∕= µ0,\)</span> where µ0 is the mean of <span class="math inline">\(χ^2(1)\)</span>, Uniform(0,2), and Exponential(1),
respectively.</p></li>
</ol>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="question-1-2" class="section level3">
<h3>Question 1</h3>
<p>we want to prove that <span class="math inline">\(\frac{Var(\hat{\theta}^S)}{Var(\hat{\theta}^M)}
\rightarrow 0\)</span> as <span class="math inline">\((b_i - a_i)
\rightarrow 0\)</span> for all <span class="math inline">\(i = 1,
\ldots, k\)</span>.</p>
<p>As <span class="math inline">\(b_i - a_i\)</span> gets closer to 0,
since <span class="math inline">\(g\)</span> is a continuous function
over <span class="math inline">\((a, b)\)</span>, as the intervals
become smaller, the variation in <span class="math inline">\(g(U)\)</span> for each <span class="math inline">\(i\)</span> also becomes smaller. Therefore, <span class="math inline">\(\sigma_i^2\)</span> will tend to 0 as <span class="math inline">\((b_i - a_i) \rightarrow 0\)</span> for all <span class="math inline">\(i\)</span>.</p>
</div>
<div id="question-2-2" class="section level3">
<h3>Question 2</h3>
<p>It’s evident that the function <span class="math inline">\(g(x)\)</span> closely resembles the probability
density function of the standard normal distribution. Therefore, we can
define <span class="math inline">\(f_1(x)\)</span> as follows <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}} e^{−x^2/2}.\]</span>
Additionally, we can use the probability density function of the Gamma
distribution for <span class="math inline">\(f_2\)</span>. The density
function of a <span class="math inline">\(Gamma(3,2)\)</span>
distribution is given by: <span class="math display">\[f_2(x)=\frac{1}{16}x^2e^{-x/2}I_{(0,\infty)}(x).\]</span></p>
<ul>
<li>Here are two figures illustrating the functions <span class="math inline">\(g, f_1, f_2\)</span>.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>(x<span class="sc">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>}</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>gs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)),<span class="fu">expression</span>(<span class="fu">f1</span>(x)),<span class="fu">expression</span>(<span class="fu">f2</span>(x)))</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># figure of g, f1, f2</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.6</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co"># figure of g/f1, g/f2</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dnorm</span>(x), <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> gs[<span class="sc">-</span><span class="dv">1</span>], <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">inset =</span> <span class="fl">0.02</span>,<span class="at">col=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figures, we can make an inference that <span class="math inline">\(f_2\)</span> may provide a more precise
estimation, as the ratio <span class="math inline">\(g/f_2\)</span>
appears closer to a constant compared to <span class="math inline">\(g/f_1\)</span>, which is a quadratic function.
Moreover, <span class="math inline">\(f_1\)</span> covers a broader
range, and many simulated values would contribute zeros to the sum,
resulting in inefficiency.</p>
<p>Now, let’s proceed with a simulation:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e4</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>theta <span class="ot">&lt;-</span> se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># using f1</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m) </span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dnorm</span>(x)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>theta[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co"># using f2</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">2</span>) </span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> <span class="fu">dgamma</span>(x,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>theta[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="fu">rbind</span>(theta, se)</span></code></pre></div>
<pre><code>##            [,1]      [,2]
## theta 0.4026291 0.4037075
## se    1.1138778 0.3027751</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>se<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 1.24072375 0.09167277</code></pre>
<p>After conducting the simulation, we can affirm that <span class="math inline">\(f_2\)</span> offers a superior estimation of <span class="math inline">\(\theta\)</span></p>
</div>
<div id="question-3-2" class="section level3">
<h3>Question 3</h3>
<p>The mass function of the original Gamma distribution is <span class="math display">\[f(x | \alpha, \beta) =
\frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha - 1} e^{-\beta x}, \quad x
&gt; 0\]</span> we need to change it into <span class="math display">\[f(x | \alpha&#39;, \beta&#39;) =
\frac{\beta&#39;^{\alpha&#39;}}{\Gamma(\alpha&#39;)} (x-1)^{\alpha&#39;
- 1} e^{-\beta&#39; (x-1)}, \quad x &gt; 1\]</span> <span class="math inline">\(α\)</span> and <span class="math inline">\(β\)</span> are the original shape and scale
parameters, while <span class="math inline">\(α&#39;\)</span> and <span class="math inline">\(β&#39;\)</span> are the redefined shape and scale
parameters, to make the distribution applicable within the interval
<span class="math inline">\((1, ∞)\)</span>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Parameters for the gamma distribution</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># Shape parameter</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">1</span>   <span class="co"># Scale parameter</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co"># Number of samples</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> (<span class="fu">mean</span>((samples<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(alpha)) <span class="sc">/</span> beta<span class="sc">^</span>alpha))</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co"># Print the estimate</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Monte Carlo Estimate:&quot;</span>, estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Monte Carlo Estimate: 23.82145</code></pre>
</div>
<div id="question-4-1" class="section level3">
<h3>Question 4</h3>
<ul>
<li>Example 5.10</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> sd1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> (x <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">*</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>}</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m) <span class="co">#f3, inverse transform method</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x) <span class="sc">/</span> (<span class="fu">exp</span>(<span class="sc">-</span>x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>est1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span></code></pre></div>
<ul>
<li>Example 5.13</li>
</ul>
<p>Let <span class="math inline">\(f(x)=\frac{e^{-x}}{1-e^{-1}}\)</span>, <span class="math inline">\(F(x)=\int f(x)=\frac{1-e^{-x}}{1-e^{-1}}\)</span>.
Then <span class="math inline">\(F^{-1}(x)=-log[1-(1-e^{-1})x)]\)</span>. We divide
the real line into <span class="math inline">\(k=5\)</span> intervals
<span class="math inline">\(I_j=\{x:a_{j-1}\leq x&lt;a_j\}\)</span> and
<span class="math inline">\(a_j=F^{-1}(\frac{j}{k}),j=1,\dots,k\)</span>. On
each subinterval, the conditional density <span class="math inline">\(f_j\)</span> of <span class="math inline">\(X\)</span> is <span class="math display">\[f_j(x)=f_{X|I_j}(x|I_j)=\frac{f(x,a_{j-1}\leq
x&lt;a_j)}{P(a_{j-1}\leq x&lt;a_j)}=kf(x),\quad a_{j-1}\leq
x&lt;a_j.\]</span></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> </span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co"># replicates per stratum</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> T2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>est2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>fj <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="dv">5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="co"># fj(x)</span></span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<p>For each subinterval <span class="math inline">\(I_j\)</span>, we use
inverse transform method to generate samples from <span class="math inline">\(f_j(x)\)</span>. Since <span class="math display">\[\begin{aligned}
F_j(x)
&amp;=\int_{a_{j-1}}^{x}f_j(x)dx\\
&amp;=5F(x)-5F(a_{j-1})\\
&amp;=5(F(x)-j+1),
\end{aligned}\]</span> we have <span class="math inline">\(F^{-1}_j(x)=-log[1-(1-e^{-1})(x+j-1)]\)</span>.<br />
Let <span class="math inline">\(\sigma_j^2=Var(g_j(X)/f_j(X))\)</span>.
For each <span class="math inline">\(j = 1,...,k\)</span>, we simulate
an importance sample size <span class="math inline">\(m\)</span>,
compute the importance sampling estimator <span class="math inline">\(\hat\theta_j\)</span> of <span class="math inline">\(\theta_j\)</span> on the <span class="math inline">\(j^{th}\)</span> subinterval, and compute <span class="math inline">\(\displaystyle\hat\theta^{SI}=\sum_{j=1}^k{\hat\theta_j}\)</span>.Then
by independence of <span class="math inline">\(\hat\theta_1,...,
\hat\theta_k\)</span>, <span class="math display">\[\displaystyle
Var(\hat\theta^{SI})=Var(\sum_{j=1}^k{\hat\theta_j})=\sum_{j=1}^k{\frac{\sigma_j^2}{m}}=\frac{1}{m}\sum_{j=1}^k{\sigma_j^2}.\]</span></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(m)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  x <span class="ot">=</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(u<span class="sc">+</span>j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>) <span class="co"># inverse transform method</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  T1[j] <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x))</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  T2[j] <span class="ot">=</span> <span class="fu">var</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">fj</span>(x))</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>}</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>est2[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">sum</span>(T1) </span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>est2[<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">sum</span>(T2)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(est1,est2[<span class="dv">1</span>]),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.5248 0.5247</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(sd1,<span class="fu">sqrt</span>(est2[<span class="dv">2</span>])),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.09678 0.00938</code></pre>
<p>From the results, it’s oblivious that the stratified importance
sampling estimate is better because its variance is much smaller than
the result of Example 5.10.</p>
</div>
<div id="question-5-1" class="section level3">
<h3>Question 5</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>true_mean <span class="ot">&lt;-</span> <span class="dv">2</span>  </span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>successful_intervals <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(s, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  </span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  </span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  moe <span class="ot">&lt;-</span> <span class="fu">qt</span>((<span class="dv">1</span> <span class="sc">+</span> cl) <span class="sc">/</span> <span class="dv">2</span>, <span class="at">df =</span> s <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (sample_sd <span class="sc">/</span> <span class="fu">sqrt</span>(s))</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>  interval <span class="ot">&lt;-</span> <span class="fu">c</span>(sample_mean <span class="sc">-</span> moe, sample_mean <span class="sc">+</span> moe)</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>  </span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a>  <span class="cf">if</span> (true_mean <span class="sc">&gt;=</span> interval[<span class="dv">1</span>] <span class="sc">&amp;&amp;</span> true_mean <span class="sc">&lt;=</span> interval[<span class="dv">2</span>]) {</span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a>    successful_intervals <span class="ot">&lt;-</span> successful_intervals <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a>  }</span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a>}</span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>c_p <span class="ot">&lt;-</span> successful_intervals <span class="sc">/</span> n</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a></span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated Coverage Probability:&quot;</span>, c_p, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated Coverage Probability: 0.9161</code></pre>
<p>The t-interval should be more robust to departures from normality
than the interval for variance.</p>
</div>
<div id="question-6-1" class="section level3">
<h3>Question 6</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>true_mean_chi_sq <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a>true_mean_uniform <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>true_mean_exponential <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>rej_chi_sq <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>rej_uniform <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>rej_exponential <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a><span class="co"># Perform Monte Carlo simulations for each case</span></span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>  </span>
<span id="cb36-15"><a href="#cb36-15" tabindex="-1"></a>  sample_chi_sq <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">30</span>, <span class="at">df =</span> <span class="dv">1</span>)  </span>
<span id="cb36-16"><a href="#cb36-16" tabindex="-1"></a>  sample_uniform <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>) </span>
<span id="cb36-17"><a href="#cb36-17" tabindex="-1"></a>  sample_exponential <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">30</span>, <span class="at">rate =</span> <span class="dv">1</span>)  </span>
<span id="cb36-18"><a href="#cb36-18" tabindex="-1"></a>  </span>
<span id="cb36-19"><a href="#cb36-19" tabindex="-1"></a>  t_test_chi_sq <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_chi_sq, <span class="at">mu =</span> true_mean_chi_sq, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb36-20"><a href="#cb36-20" tabindex="-1"></a>  t_test_uniform <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_uniform, <span class="at">mu =</span> true_mean_uniform, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb36-21"><a href="#cb36-21" tabindex="-1"></a>  t_test_exponential <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_exponential, <span class="at">mu =</span> true_mean_exponential, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb36-22"><a href="#cb36-22" tabindex="-1"></a>  </span>
<span id="cb36-23"><a href="#cb36-23" tabindex="-1"></a>  <span class="cf">if</span> (t_test_chi_sq<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb36-24"><a href="#cb36-24" tabindex="-1"></a>    rej_chi_sq <span class="ot">&lt;-</span> rej_chi_sq <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-25"><a href="#cb36-25" tabindex="-1"></a>  }</span>
<span id="cb36-26"><a href="#cb36-26" tabindex="-1"></a>  </span>
<span id="cb36-27"><a href="#cb36-27" tabindex="-1"></a>  <span class="cf">if</span> (t_test_uniform<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb36-28"><a href="#cb36-28" tabindex="-1"></a>    rej_uniform <span class="ot">&lt;-</span> rej_uniform <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-29"><a href="#cb36-29" tabindex="-1"></a>  }</span>
<span id="cb36-30"><a href="#cb36-30" tabindex="-1"></a>  </span>
<span id="cb36-31"><a href="#cb36-31" tabindex="-1"></a>  <span class="cf">if</span> (t_test_exponential<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb36-32"><a href="#cb36-32" tabindex="-1"></a>    rej_exponential <span class="ot">&lt;-</span> rej_exponential <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb36-33"><a href="#cb36-33" tabindex="-1"></a>  }</span>
<span id="cb36-34"><a href="#cb36-34" tabindex="-1"></a>}</span>
<span id="cb36-35"><a href="#cb36-35" tabindex="-1"></a></span>
<span id="cb36-36"><a href="#cb36-36" tabindex="-1"></a>t1e_chi_sq <span class="ot">&lt;-</span> rej_chi_sq <span class="sc">/</span> n</span>
<span id="cb36-37"><a href="#cb36-37" tabindex="-1"></a>t1e_uniform <span class="ot">&lt;-</span> rej_uniform <span class="sc">/</span> n</span>
<span id="cb36-38"><a href="#cb36-38" tabindex="-1"></a>t1e_exponential <span class="ot">&lt;-</span> rej_exponential <span class="sc">/</span> n</span>
<span id="cb36-39"><a href="#cb36-39" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb36-41"><a href="#cb36-41" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Type I Error Rate for χ²(1) Data:&quot;</span>, t1e_chi_sq, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Type I Error Rate for χ²(1) Data: 0.0966</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Type I Error Rate for Uniform(0,2) Data:&quot;</span>, t1e_uniform, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Type I Error Rate for Uniform(0,2) Data: 0.0514</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Type I Error Rate for Exponential(1) Data:&quot;</span>, t1e_exponential, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Type I Error Rate for Exponential(1) Data: 0.0744</code></pre>
</div>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>考虑<span class="math inline">\(m=1000\)</span>个假设，其中前95%个原假设成立，后5%个对立假设成立。在原假设下，<span class="math inline">\(p\sim U(0,1)\)</span>，在对立假设下，<span class="math inline">\(p\sim
Beta(0.1,1)\)</span>（可用rbeta生成）。应用Bonferroni矫正方法与BH矫正应用于生成的m个p值，得到矫正后的<span class="math inline">\(p-value\)</span>，与<span class="math inline">\(\alpha=0.1\)</span>比较确定是否拒绝原假设。基于M=1000次模拟，可估计FWER、FDR、TPR，输出到表格中。</p></li>
<li><p>Suppose the population has the exponential distribution with rate
<span class="math inline">\(λ\)</span>, then the MLE of λ is <span class="math inline">\(\hat{\lambda} = 1/\bar{X}\)</span> , where <span class="math inline">\(\bar{X}\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat{λ}\)</span> is λn/(n − 1), so that the
estimation bias is λ/(n − 1). The standard error <span class="math inline">\(\hat{λ}\)</span> is λn/[(n − 1)√n − 2]. Conduct a
simulation study to verify the performance of the bootstrap method. The
true value of λ = 2. The sample size n = 5, 10, 20. The number of
bootstrap replicates B = 1000. The simulations are repeated for m = 1000
times. Compare the mean bootstrap bias and bootstrap standard error with
the theoretical ones. Comment on the results.</p></li>
<li><p>(7.3) Obtain a bootstrap t confidence interval estimate for the
correlation statistic in Example 7.2 (law data in bootstrap)</p></li>
</ol>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="question-1-3" class="section level3">
<h3>Question 1</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co"># bonferroni</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>FWER <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>FDR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a>TPR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p1,p2)</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a>  FWER[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>  FDR[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p<span class="sc">&lt;</span>alpha)</span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a>  TPR[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&gt;</span>alpha)<span class="sc">/</span>(<span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&gt;</span>alpha)<span class="sc">+</span><span class="fu">sum</span>(p[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="sc">&lt;</span>alpha))</span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a>}</span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean FWER:&quot;</span>, <span class="fu">mean</span>(FWER), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean FWER: 0.094</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean FDR:&quot;</span>, <span class="fu">mean</span>(FDR), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean FDR: 0.004665936</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean TPR:&quot;</span>, <span class="fu">mean</span>(TPR), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean TPR: 0.9794942</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">114514</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="co"># BH</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>FWER <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>FDR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>TPR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">950</span>)</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">50</span>,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p1,p2)</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a>  FWER[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>  FDR[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p<span class="sc">&lt;</span>alpha)</span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a>  TPR[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&gt;</span>alpha)<span class="sc">/</span>(<span class="fu">sum</span>(p[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&gt;</span>alpha)<span class="sc">+</span><span class="fu">sum</span>(p[<span class="dv">951</span><span class="sc">:</span><span class="dv">1000</span>]<span class="sc">&lt;</span>alpha))</span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>}</span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean FWER:&quot;</span>, <span class="fu">mean</span>(FWER), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean FWER: 0.93</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean FDR:&quot;</span>, <span class="fu">mean</span>(FDR), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean FDR: 0.0935405</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean TPR:&quot;</span>, <span class="fu">mean</span>(TPR), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean TPR: 0.9710314</code></pre>
</div>
</div>
</div>
<div id="correction-results" class="section level1">
<h1>Correction Results</h1>
<table>
<thead>
<tr class="header">
<th>Metric</th>
<th>Bonferroni Correction</th>
<th>BH Correction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mean FWER</td>
<td>0.094</td>
<td>0.93</td>
</tr>
<tr class="even">
<td>Mean FDR</td>
<td>0.004</td>
<td>0.093</td>
</tr>
<tr class="odd">
<td>Mean TPR</td>
<td>0.979</td>
<td>0.971</td>
</tr>
</tbody>
</table>
<div id="question-2-3" class="section level3">
<h3>Question 2</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co">#set.seed(114514)</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> n){</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(j,lambda)</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>  xstar <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a>    xstar[i] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(<span class="fu">sample</span>(x,B,<span class="at">replace =</span> T))</span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>  }</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;n=&quot;</span>,j,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Bootstrap method vs theoretical on Bias:&quot;</span>,<span class="fu">mean</span>(xstar)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x),lambda<span class="sc">*</span>j<span class="sc">/</span>(j<span class="dv">-1</span>)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-14"><a href="#cb54-14" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Bootstrap method vs theoretical on SE:&quot;</span>,<span class="fu">sd</span>(xstar),lambda<span class="sc">*</span>j<span class="sc">/</span>((j<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(j<span class="dv">-2</span>)),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-15"><a href="#cb54-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n= 5 
## Bootstrap method vs theoretical on Bias: 0.002962551 -0.6097401 
## Bootstrap method vs theoretical on SE: 0.06217398 1.443376 
## n= 10 
## Bootstrap method vs theoretical on Bias: 0.001063442 0.9566054 
## Bootstrap method vs theoretical on SE: 0.04190579 0.7856742 
## n= 20 
## Bootstrap method vs theoretical on Bias: 0.002720666 -0.5059447 
## Bootstrap method vs theoretical on SE: 0.06390655 0.4962153</code></pre>
<p>It is obvious that using Bootstrap can reduce both the Bias and
standard error, regardless of the sample size in n.</p>
</div>
<div id="question-3-3" class="section level3">
<h3>Question 3</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="co">#set up the bootstrap</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span> <span class="co">#number of replicates</span></span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(law) <span class="co">#sample size</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co">#storage for replicates</span></span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a><span class="co">#bootstrap estimate of standard error of R</span></span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT,law<span class="sc">$</span>GPA)</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a><span class="co">#randomly select the indices</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>LSAT <span class="ot">&lt;-</span> law<span class="sc">$</span>LSAT[i] <span class="co">#i is a vector of indices</span></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>GPA <span class="ot">&lt;-</span> law<span class="sc">$</span>GPA[i]</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>R[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT, GPA)</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>}</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a><span class="co">#output</span></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>t <span class="ot">&lt;-</span> (R<span class="sc">-</span>r)<span class="sc">/</span><span class="fu">sd</span>(R)</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Bootstrap t Confidence Interval for Correlation:&quot;</span>,r<span class="sc">+</span><span class="fu">quantile</span>(t, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))<span class="sc">*</span><span class="fu">sd</span>(R))</span></code></pre></div>
<pre><code>## Bootstrap t Confidence Interval for Correlation: 0.4598658 0.9518869</code></pre>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>(7.5) Refer to Exercise 7.4. Compute 95% bootstrap confidence
intervals for the mean time between failures <span class="math inline">\(1/λ\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.。</p></li>
<li><p>(7.8).Refer to Exercise 7.7. Obtain the jackknife estimates of
bias and standard error of <span class="math inline">\(θ\)</span></p></li>
<li><p>(7.11) In Example 7.18, leave-one-out (n-fold) cross validation
was used to select the best fitting model. Use leave-two-out cross
validation to compare the models.</p></li>
</ol>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="question-1-4" class="section level3">
<h3>Question 1</h3>
<p>Recall the four methods first.<br />
</p>
<ul>
<li>standard normal:<span class="math inline">\((\hat\theta-z_{1-\alpha/2}\hat{se}(\hat\theta),\hat\theta-z_{\alpha/2}\hat{se}(\hat\theta))\)</span></li>
<li>basic:<span class="math inline">\((2\hat\theta-\hat\theta^*_{1-\alpha/2},2\hat\theta-\hat\theta^*_{\alpha/2})\)</span></li>
<li>percentile:<span class="math inline">\((\hat\theta^*_{\alpha/2},\hat\theta^*_{1-\alpha/2})\)</span></li>
<li>BCa:<span class="math inline">\((\hat\theta_{\alpha_1}^*,\hat\theta_{\alpha_2}^*)\)</span>
<span class="math display">\[\alpha_1=\phi(\hat z_0+\frac{\hat
z_0+z_{\alpha/2}}{1-\hat a(\hat z_0+z_{\alpha/2})}),\alpha_2=\phi(\hat
z_0+\frac{\hat z_0+z_{1-\alpha/2}}{1-\hat a(\hat
z_0+z_{1-\alpha/2})})\]</span> <span class="math display">\[\hat
z_0=\phi^{-1}(\frac{1}{B}\sum_{i=1}^n
I(\hat\theta^{(b)}&lt;\hat\theta)),\hat
a=\frac{\sum_{i=1}^n(\bar\theta-\theta_i)^3}{6(\sum_{i=1}^n(\bar\theta-\theta_i)^2)^{3/2}}\]</span>
We can use the <strong>boot</strong> and <strong>boot.ci</strong>
functions to construct confidence intervals.</li>
</ul>
<p>The comparison reveals that both the basic and percentile methods
yield intervals of similar length, closely approximating the normal
method. In contrast, the BCa method produces longer intervals than the
other three. The basic method’s confidence interval leans more toward
the left, while the confidence intervals of the normal, percentile, and
BCa methods shift towards the right. This suggests that both the upper
and lower bounds have increased.</p>
</div>
<div id="question-2-4" class="section level3">
<h3>Question 2</h3>
<p>We use “leave-one-out” to obtain <span class="math inline">\(\hat\Sigma_{(i)}\)</span> and compute <span class="math inline">\(\hat\theta_{(i)}\)</span>. Notice that the MLE of
<span class="math inline">\(\Sigma\)</span> is <span class="math display">\[\hat\Sigma=\frac{1}{n}\sum_{i=1}^n(X_{(i)}-\bar
X)(X_{(i)}-\bar X)^T\]</span>, so we need to slightly modify the
cov(X).</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;scor&quot;</span>,<span class="at">package=</span><span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>data1 <span class="ot">=</span> scor</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">nrow</span>(data1)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>sigma.hat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>lambda.hat <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>theta.jack <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>  data_jack <span class="ot">=</span> data1[<span class="sc">-</span>i,]  <span class="co"># leave-one-out</span></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>  sigma.hat <span class="ot">=</span> (n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">cov</span>(data_jack)<span class="sc">/</span>(n<span class="dv">-1</span>) <span class="co"># MLE of Sigma</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  lambda.hat <span class="ot">=</span> <span class="fu">eigen</span>(sigma.hat)<span class="sc">$</span>values</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  theta.jack[i] <span class="ot">=</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>sigma <span class="ot">=</span> (n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">cov</span>(data1)<span class="sc">/</span>n</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>lambda.hat <span class="ot">=</span> <span class="fu">eigen</span>(sigma)<span class="sc">$</span>values</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>theta.hat <span class="ot">=</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>bias.jack <span class="ot">=</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>se.jack <span class="ot">=</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.hat))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## bias.jack   se.jack 
##     0.001     0.050</code></pre>
</div>
<div id="question-3-4" class="section level3">
<h3>Question 3</h3>
<p>To perform leave-two-out cross-validation, follow these steps:</p>
<ol style="list-style-type: decimal">
<li><p>Iterate through <span class="math inline">\(i=1,2,\dots,n\)</span> and <span class="math inline">\(j=1,2,\dots,n\)</span> with the constraint <span class="math inline">\(i\neq j\)</span>. Take <span class="math inline">\((x_i,y_i)\)</span> and <span class="math inline">\((x_j,y_j)\)</span> as the test points while using
the remaining observations to fit the model. Calculate the prediction
errors as follows: <span class="math inline">\(e_{ij1}=y_i-\hat
y_i\)</span> and <span class="math inline">\(e_{ij2}=y_j-\hat
y_j\)</span>.</p></li>
<li><p>Estimate the mean of the squared prediction errors using the
formula: <span class="math inline">\(\displaystyle\hat\sigma_{\epsilon}^2=\frac{2}{n(n-1)}\sum_{i=1}^{n-1}\sum_{j=i+1}^n
e_{ij}^2\)</span>, where <span class="math inline">\(e_{ij}^2\)</span>
is defined as <span class="math inline">\(\frac{e_{ij1}^2+e_{ij2}^2}{2}\)</span>.</p></li>
</ol>
<p>Note that the matrix <span class="math inline">\(e_k\)</span>
contains <span class="math inline">\(n(n+1)/2\)</span> zeros, so it’s
necessary to make a slight adjustment in the mean calculation when
computing it.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">library</span>(DAAG); <span class="fu">attach</span>(ironslag)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) </span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,n) <span class="co"># store the squared prediction errors</span></span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>    </span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>    e1[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a>  </span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb61-16"><a href="#cb61-16" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[<span class="fu">c</span>(i,j)]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb61-17"><a href="#cb61-17" tabindex="-1"></a>    e2[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-18"><a href="#cb61-18" tabindex="-1"></a>  </span>
<span id="cb61-19"><a href="#cb61-19" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb61-20"><a href="#cb61-20" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[<span class="fu">c</span>(i,j)]</span>
<span id="cb61-21"><a href="#cb61-21" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb61-22"><a href="#cb61-22" tabindex="-1"></a>    e3[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-23"><a href="#cb61-23" tabindex="-1"></a>    </span>
<span id="cb61-24"><a href="#cb61-24" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb61-25"><a href="#cb61-25" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[<span class="fu">c</span>(i,j)])</span>
<span id="cb61-26"><a href="#cb61-26" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb61-27"><a href="#cb61-27" tabindex="-1"></a>    e4[i,j] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[<span class="fu">c</span>(i,j)] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb61-28"><a href="#cb61-28" tabindex="-1"></a>  }</span>
<span id="cb61-29"><a href="#cb61-29" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>Based on the prediction error criterion, Model 2, which is the
quadratic model, appears to be the most suitable fit for the data. This
outcome aligns with the findings of the leave-one-out method.</p>
</div>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm
in continuous situation</p></li>
<li><p>(8.1).Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2</p></li>
<li><p>(8.3) The Count 5 test for equal variances in Section 6.4 is
based on the maximum number of extreme points. Example 6.15 shows that
the Count 5 criterion is not applicable for unequal sample sizes.
Implement a permutation test for equal variance based on the maximum
number of extreme points that applies when sample sizes are not
necessarily equal</p></li>
</ol>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="question-1-5" class="section level3">
<h3>Question 1</h3>
<p>要证<span class="math inline">\(\pi_ip_{ij}=\pi_jp_{ji}\)</span>，首先证明<span class="math inline">\(p_{ij}=a_{ij}q_{ij}\)</span>。</p>
<p><span class="math inline">\(i\neq j\)</span>时，<span class="math display">\[p_{ij}=P(X_{n+1}=j|X_n=i)P(\alpha_{ij}\leq
u)+P(X_{n+1}=j|X_n=i)P(u&lt;\alpha_{ij})\]</span> <span class="math display">\[=P(X_{n+1}=j|X_n=i)P(u&lt;\alpha_{ij})=q_{ij}a_{ij}\]</span>
<span class="math inline">\(i = j\)</span>时，<span class="math display">\[p_{ij}=P(X_{n+1}=j|X_n=i)P(\alpha_{ij}\leq
u)+P(X_{n+1}=j|X_n=i)P(u&lt;\alpha_{ij})\]</span> <span class="math display">\[=P(\alpha_{ij}\leq
u)+P(X_{n+1}=j|X_n=i)P(u&lt;\alpha_{ij})=1-a_{ij}+q_{ij}a_{ij}=q_{ij}a_{ij}\]</span>
因此， <span class="math display">\[\pi_ip_{ij}=\pi_iq_{ij}a_{ij}=\pi_iq_{ij}min(1,\frac{\pi_jq_{ji}}{\pi_iq_{ij}})\]</span>
<span class="math display">\[=min(\pi_jq_{ji},\pi_iq_{ij})=\pi_jq_{ji}min(1,\frac{\pi_iq_{ij}}{\pi_jq_{ji}})=\pi_jp_{ji}\]</span></p>
</div>
<div id="question-2-5" class="section level3">
<h3>Question 2</h3>
<ul>
<li>Two-sample tests for univariate data (continued)
<ul>
<li>Cramer-von Mises statistic <span class="math display">\[
  W_2=\frac{mn}{(m+n)^2}\left[
  \sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2\right]
  \]</span> <span class="math inline">\(F_n\)</span>: the ecdf of the
sample <span class="math inline">\(x_1,\ldots,x_n\)</span>; <span class="math inline">\(G_m\)</span>: the ecdf of the sample <span class="math inline">\(y_1,\ldots,y_m\)</span>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span></code></pre></div>
<pre><code>## The following object is masked _by_ .GlobalEnv:
## 
##     weight</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span></code></pre></div>
</div>
<div id="question-3-5" class="section level3">
<h3>Question 3</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>}</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span> <span class="co">#number of replicates</span></span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y) <span class="co">#pooled sample</span></span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb67-22"><a href="#cb67-22" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R) <span class="co">#storage for replicates</span></span>
<span id="cb67-23"><a href="#cb67-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb67-24"><a href="#cb67-24" tabindex="-1"></a><span class="co">#generate indices k for the first sample</span></span>
<span id="cb67-25"><a href="#cb67-25" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-26"><a href="#cb67-26" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb67-27"><a href="#cb67-27" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb67-28"><a href="#cb67-28" tabindex="-1"></a>reps[i] <span class="ot">&lt;-</span> <span class="fu">count5test</span>(x1,y1)</span>
<span id="cb67-29"><a href="#cb67-29" tabindex="-1"></a>}</span>
<span id="cb67-30"><a href="#cb67-30" tabindex="-1"></a><span class="fu">mean</span>(reps)</span></code></pre></div>
<pre><code>## [1] 0.1551552</code></pre>
</div>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="question-11" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Consider a model <span class="math inline">\(P(Y = 1 | X1, X2,
X3) =
\frac{exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>,
where X1 ∼ P(1), X2 ∼ Exp(1) and X3 ∼ B(1, 0.5). • Design a function
that takes as input values N, b1, b2, b3 and f0, and produces the output
a. • Call this function, input values are N = 106, b1 = 0, b2 = 1, b3 =
−1, f0 = 0.1, 0.01, 0.001, 0.0001. • Plot − log f0 vs a.</p></li>
<li><p>(9.4).Implement a random walk Metropolis sampler for generating
the standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p></li>
<li><p>(9.7) Implement a Gibbs sampler to generate a bivariate normal
chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means,
unit standard deviations, and correlation 0.9. Plot the generated sample
after discarding a suitable burn-in sample. Fit a simple linear
regression model <span class="math inline">\(Y = \beta_0 +
\beta_1X\)</span> to the sample and check the residuals of the model for
normality and constant variance.</p></li>
<li><p>(9.10) Refer to Example 9.1. Use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>. (See Exercise 9.9.)
Also use the coda [212] package to check for convergence of the chain by
the Gelman-Rubin method. Hints: See the help topics for the coda
functions gelman.diag, gelman.plot, as.mcmc, and mcmc.list.</p></li>
</ol>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="question-1-6" class="section level3">
<h3>Question 1</h3>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>fun <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha){</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3); p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>  }</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a>  solution<span class="sc">$</span>root</span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>}</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">fun</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,f0[i])</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a>}</span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),a,<span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2-6" class="section level3">
<h3>Question 2</h3>
<p>The density function of Laplace distribution is <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>, so <span class="math inline">\(r(x_t,y)=\frac{f(Y)}{f(X_t)}=e^{|y|-|x|}\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>}</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>invF <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)))</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>}</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>rw.Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x0</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">f</span>(y)<span class="sc">/</span><span class="fu">f</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>    x[i] <span class="ot">=</span> y <span class="cf">else</span> {</span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>    x[i] <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a>    k <span class="ot">=</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a>  }</span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>}</span>
<span id="cb70-21"><a href="#cb70-21" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb70-22"><a href="#cb70-22" tabindex="-1"></a>}</span>
<span id="cb70-23"><a href="#cb70-23" tabindex="-1"></a></span>
<span id="cb70-24"><a href="#cb70-24" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb70-25"><a href="#cb70-25" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb70-26"><a href="#cb70-26" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb70-27"><a href="#cb70-27" tabindex="-1"></a>  psi <span class="ot">=</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb70-28"><a href="#cb70-28" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb70-29"><a href="#cb70-29" tabindex="-1"></a>  k <span class="ot">=</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb70-30"><a href="#cb70-30" tabindex="-1"></a>  psi.means <span class="ot">=</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb70-31"><a href="#cb70-31" tabindex="-1"></a>  B <span class="ot">=</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb70-32"><a href="#cb70-32" tabindex="-1"></a>  psi.w <span class="ot">=</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb70-33"><a href="#cb70-33" tabindex="-1"></a>  W <span class="ot">=</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb70-34"><a href="#cb70-34" tabindex="-1"></a>  v.hat <span class="ot">=</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb70-35"><a href="#cb70-35" tabindex="-1"></a>  r.hat <span class="ot">=</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb70-36"><a href="#cb70-36" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb70-37"><a href="#cb70-37" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">12000</span> <span class="co">#length of chains</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>) <span class="co">#different initial values</span></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">5</span>) <span class="co">#different variance</span></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X2 <span class="ot">&lt;-</span> X3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,n)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>rej <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>refline <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">invF</span>(<span class="fl">0.975</span>), <span class="fu">invF</span>(<span class="fl">0.975</span>))</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a></span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>  rw1 <span class="ot">=</span> <span class="fu">rw.Laplace</span>(sigma[<span class="dv">1</span>], x0[i], n)</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>  rw2 <span class="ot">=</span> <span class="fu">rw.Laplace</span>(sigma[<span class="dv">2</span>], x0[i], n)</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>  rw3 <span class="ot">=</span> <span class="fu">rw.Laplace</span>(sigma[<span class="dv">3</span>], x0[i], n)</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>  X1[i,]<span class="ot">=</span>rw1<span class="sc">$</span>x;X2[i,]<span class="ot">=</span>rw2<span class="sc">$</span>x;X3[i,]<span class="ot">=</span>rw3<span class="sc">$</span>x</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>  rej[,i] <span class="ot">=</span> <span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k)</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>}</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" tabindex="-1"></a><span class="co"># compute diagnostic statistics</span></span>
<span id="cb71-20"><a href="#cb71-20" tabindex="-1"></a>psi1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X1, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-21"><a href="#cb71-21" tabindex="-1"></a>psi2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X2, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-22"><a href="#cb71-22" tabindex="-1"></a>psi3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X3, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-23"><a href="#cb71-23" tabindex="-1"></a></span>
<span id="cb71-24"><a href="#cb71-24" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb71-25"><a href="#cb71-25" tabindex="-1"></a>  psi1[i,] <span class="ot">=</span> psi1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi1))</span>
<span id="cb71-26"><a href="#cb71-26" tabindex="-1"></a>  psi2[i,] <span class="ot">=</span> psi2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi2))</span>
<span id="cb71-27"><a href="#cb71-27" tabindex="-1"></a>  psi3[i,] <span class="ot">=</span> psi3[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi3))</span>
<span id="cb71-28"><a href="#cb71-28" tabindex="-1"></a>}</span>
<span id="cb71-29"><a href="#cb71-29" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psi1),<span class="fu">Gelman.Rubin</span>(psi2),<span class="fu">Gelman.Rubin</span>(psi3)))</span></code></pre></div>
<pre><code>## [1] 1.153902 1.096606 1.069531</code></pre>
<p>We choose the first chain of each variance and plot the generated
samples. Also, we plot the <span class="math inline">\(\hat R\)</span>
over time 1001 to 12000 to monitor convergence.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">apply</span>(rej, <span class="dv">1</span>, mean)<span class="sc">/</span>n</span></code></pre></div>
<pre><code>## [1] 0.8297292 0.5280208 0.2873750</code></pre>
<p>From the results, the value of <span class="math inline">\(\hat
R\)</span> is below 1.2 within approximately 9000, 3000, 1500 iterations
for <span class="math inline">\(\sigma=0.5,2,5\)</span>, respectively,
which implies that the chain has converged to the target distribution.
It’s evident that as the variance become larger, the chain will converge
faster but the acceptance rate will become smaller.</p>
</div>
<div id="question-3-6" class="section level3">
<h3>Question 3</h3>
<p>First we define a function to use Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>Gibbs.binorm <span class="ot">&lt;-</span> <span class="cf">function</span>(N,<span class="at">mu1=</span><span class="dv">0</span>,<span class="at">mu2=</span><span class="dv">0</span>,<span class="at">sigma1=</span><span class="dv">1</span>,<span class="at">sigma2=</span><span class="dv">1</span>,<span class="at">rho=</span><span class="fl">0.9</span>,<span class="at">x0=</span><span class="fu">c</span>(mu1,mu2)){</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">=</span> x0</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>    y1 <span class="ot">=</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>    m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (y1 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>    X[i, <span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>    x1 <span class="ot">=</span> X[i, <span class="dv">1</span>]</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>    m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>    X[i, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>  }</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>}</span></code></pre></div>
<p>To monitor the convergence of the chain, we set the scalar summary
statistic <span class="math inline">\(\psi_{ij}\)</span> as the mean of
the <span class="math inline">\(i^{th}\)</span> chain up to time <span class="math inline">\(j\)</span> and do the process separately for <span class="math inline">\(X_t\)</span> and <span class="math inline">\(Y_t\)</span>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span> <span class="co">#length of chain</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span><span class="sc">*</span>k)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>Xt <span class="ot">&lt;-</span> Yt <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,N)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>x0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="dv">2</span>),<span class="dv">4</span>) <span class="co">#initial values</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>psix <span class="ot">=</span> psiy <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,k,N)</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>  X[,(<span class="dv">2</span><span class="sc">*</span>i<span class="dv">-1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>i)] <span class="ot">=</span> <span class="fu">Gibbs.binorm</span>(N,<span class="at">x0=</span>x0[i,])</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>  Xt[i,] <span class="ot">=</span> <span class="fu">t</span>(X[,<span class="dv">2</span><span class="sc">*</span>i<span class="dv">-1</span>])</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>  Yt[i,] <span class="ot">=</span> <span class="fu">t</span>(X[,<span class="dv">2</span><span class="sc">*</span>i])</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>}</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>psix <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Xt, <span class="dv">1</span>, cumsum))</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>psiy <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Yt, <span class="dv">1</span>, cumsum))</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a>  psix[i,] <span class="ot">=</span> psix[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psix))</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>  psiy[i,] <span class="ot">=</span> psiy[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psiy))</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>}</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">Gelman.Rubin</span>(psix),<span class="fu">Gelman.Rubin</span>(psiy)))</span></code></pre></div>
<pre><code>## [1] 1.003882 1.017699</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>rhatx <span class="ot">=</span> rhaty <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a>  rhatx[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psix[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a>  rhaty[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psiy[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>}</span></code></pre></div>
<p>The figures of <span class="math inline">\(\hat R\)</span> shows that
the chain converges approximately within 2000 iterations. Next, we use
the first generated chain to show the samples and other chains’ figure
is similar to it. The generated samples are shown as below. The scatter
plot seems like an ellipse which conforms to a bivariate normal
distribution.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[t]),</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(Y[t]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">lm</span>(x[,<span class="dv">2</span>] <span class="sc">~</span> x[,<span class="dv">1</span>]) <span class="co">#linear model Y=a+bX</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = x[, 2] ~ x[, 1])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.79665 -0.29891  0.00383  0.29448  1.58147 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.003998   0.004600  -0.869    0.385    
## x[, 1]       0.897740   0.004656 192.795   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4364 on 8998 degrees of freedom
## Multiple R-squared:  0.8051, Adjusted R-squared:  0.8051 
## F-statistic: 3.717e+04 on 1 and 8998 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="50%" height="50%" /><img src="data:image/png;base64,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" width="50%" height="50%" /><img src="data:image/png;base64,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" width="50%" height="50%" /><img src="data:image/png;base64,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" width="50%" height="50%" /></p>
<p>From the QQ plot we can see that the residuals of the model
approximately follow a normal distribution. Besides, from the
Scale-Location plot we can see that the trend line is nearly horizontal
so the residuals have constant variance.</p>
</div>
<div id="question-4-2" class="section level3">
<h3>Question 4</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a><span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>}</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb83-16"><a href="#cb83-16" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb83-17"><a href="#cb83-17" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb83-18"><a href="#cb83-18" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb83-19"><a href="#cb83-19" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb83-20"><a href="#cb83-20" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb83-21"><a href="#cb83-21" tabindex="-1"></a>}</span>
<span id="cb83-22"><a href="#cb83-22" tabindex="-1"></a>}</span>
<span id="cb83-23"><a href="#cb83-23" tabindex="-1"></a></span>
<span id="cb83-24"><a href="#cb83-24" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">5000</span><span class="sc">:</span><span class="dv">5500</span></span>
<span id="cb83-25"><a href="#cb83-25" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x[index]</span>
<span id="cb83-26"><a href="#cb83-26" tabindex="-1"></a><span class="fu">plot</span>(index, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> x</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>}</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>}</span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a></span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">5000</span><span class="sc">:</span><span class="dv">5500</span></span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> x[index]</span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a><span class="fu">plot</span>(index, y1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;x&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">as.mcmc</span>(x))</span></code></pre></div>
<pre><code>## 
## Iterations = 1:10000
## Thinning interval = 1 
## Number of chains = 1 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##        5.04802        2.59260        0.02593        0.06748 
## 
## 2. Quantiles for each variable:
## 
##   2.5%    25%    50%    75%  97.5% 
##  0.958  3.070  4.782  6.677 10.855</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>mcmc_obj <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">mcmc</span>(x0),<span class="fu">mcmc</span>(x))</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="co"># 查看 summary</span></span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a><span class="fu">summary</span>(mcmc_obj)</span></code></pre></div>
<pre><code>## 
## Iterations = 1:10000
## Thinning interval = 1 
## Number of chains = 2 
## Sample size per chain = 10000 
## 
## 1. Empirical mean and standard deviation for each variable,
##    plus standard error of the mean:
## 
##           Mean             SD       Naive SE Time-series SE 
##        4.31628        2.99992        0.02121        0.23885 
## 
## 2. Quantiles for each variable:
## 
##      2.5%       25%       50%       75%     97.5% 
## 2.006e-04 2.099e+00 4.175e+00 6.312e+00 1.070e+01</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">gelman.diag</span>(mcmc_obj)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(mcmc_obj)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="question-12" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(X_1,...,X_n\sim Exp(\lambda),u_i\leq
X_i\leq v_i\)</span>，(1)Solve <span class="math inline">\(\lambda_{MLE}\)</span> by maximizing the
likelihood of the observed data directly and EM algorithm. Prove the EM
method’s linear convergence. (2)Let <span class="math inline">\((u_i,v_i)\)</span> be
c(11,12,8,9,27,28,13,14,16,17,0,1,23,24,10,11,24,25,2,3). Get the
numeric solution of both methods.</p></li>
<li><p>(11.8).In the Morra game, the set of optimal strategies are not
changed if a constant is subtracted from every entry of the payoff
matrix, or a positive constant is multiplied times every entry of the
payoff matrix. However, the simplex algorithm may terminate at a
different basic feasible point (also optimal). Compute B &lt;- A + 2,
find the solution of game B, and verify that it is one of the extreme
points (11.12)–(11.15) of the original game A. Also find the value of
game A and game B.</p></li>
</ol>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="question-1-7" class="section level3">
<h3>Question 1</h3>
<p><strong>Directly Optimize</strong></p>
<p>The likelihood function for the observed data is <span class="math display">\[L(\lambda)=\prod_{i=1}^nP(u_i\leq X_i\leq
v_i)=\prod_{i=1}^n(e^{-\lambda u_i}-e^{-\lambda v_i}),\]</span> then we
have <span class="math display">\[logL=\sum_{i=1}^nlog(e^{-\lambda
u_i}-e^{-\lambda v_i}),\]</span> <span class="math display">\[\frac{\partial
logL}{\partial\lambda}=-\lambda\sum_{i=1}^n \frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}.\]</span>
We can obtain the MLE <span class="math inline">\(\hat\lambda\)</span>
by solving the equation <span class="math inline">\(\frac{\partial
logL}{\partial\lambda}=0\)</span>. Codes for achieving the process are
as below(here we can use optimize() to maximize <span class="math inline">\(logL\)</span> directly).</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">12</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">27</span>,<span class="dv">28</span>,<span class="dv">13</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">23</span>,<span class="dv">24</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">24</span>,<span class="dv">25</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(data, <span class="at">nrow=</span><span class="dv">10</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>u <span class="ot">=</span> X[,<span class="dv">1</span>]; v <span class="ot">=</span> X[,<span class="dv">2</span>]</span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>logL <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>  s <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>}</span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">optimize</span>(logL, <span class="at">lower=</span><span class="dv">0</span>, <span class="at">upper=</span><span class="dv">5</span>, <span class="at">maximum=</span><span class="cn">TRUE</span>)</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>lambdahat <span class="ot">=</span> res[[<span class="dv">1</span>]]</span></code></pre></div>
<p><strong>EM algorithm</strong></p>
<p>1.Initiate <span class="math inline">\(\lambda\)</span> as <span class="math inline">\(\lambda_0\)</span><br />
2.E-step: When the interval is given, the conditional expectation is:
<span class="math display">\[E(X|u&lt;X\leq v)=\int_u^v\frac{\lambda_0
xe^{-\lambda_0 x}}{e^{-\lambda_0 u}-e^{-\lambda_0 v}}dx
=\frac{ue^{-\lambda_0 u}-ve^{-\lambda_0 v}}{e^{-\lambda_0
u}-e^{-\lambda_0 v}}+\frac{1}{\lambda_0}.\]</span> 3.M-step: the
log-likelihood is <span class="math display">\[logL=\frac{n}{\lambda}-\lambda\sum_{i=1}^n(\frac{u_ie^{-\lambda_0
u_i}-v_ie^{-\lambda_0 v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0
v_i}}+\frac{1}{\lambda_0}),\]</span> so by maximizing <span class="math inline">\(logL\)</span>, we can obtain <span class="math display">\[\lambda_1=\frac{n}{\sum_{i=1}^n\frac{u_ie^{-\lambda_0
u_i}-v_ie^{-\lambda_0 v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0
v_i}}+\frac{n}{\lambda_0}}.\]</span> 4.In steps 2 and 3, replace <span class="math inline">\(\lambda_0\)</span> with <span class="math inline">\(\lambda_1\)</span>, and repeat this process until
convergence (iteration).</p>
<p>Denote <span class="math inline">\(f(\lambda)=\frac{n}{\sum_{i=1}^n\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda
v_i}}+\frac{n}{\lambda}}\)</span>. We can compute <span class="math inline">\(|f&#39;(\lambda)|&lt;1\)</span> and by the
contraction mapping theorem, the EM process converges to a fixed point
<span class="math inline">\(\tilde\lambda\)</span> which satisfies <span class="math inline">\(\tilde\lambda=f(\tilde\lambda)\)</span>.
Specificly, <span class="math inline">\(\tilde\lambda\)</span> satisfies
<span class="math display">\[\tilde\lambda\sum_{i=1}^n\frac{u_ie^{-\tilde\lambda
u_i}-v_ie^{-\tilde\lambda v_i}}{e^{-\tilde\lambda u_i}-e^{-\tilde\lambda
v_i}}+n=n.\]</span> This is the same equation as <span class="math inline">\(\frac{\partial logL}{\partial\lambda}=0\)</span>
so we claim that <span class="math inline">\(\hat\lambda=\tilde\lambda\)</span>, which means EM
algorithm has the same value as optimizing directly.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>delta <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">100</span>) </span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>lambda[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span> <span class="co">#initialize </span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a><span class="co"># E-step</span></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>Econd <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda,u,v){ </span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  (u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>lambda</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>}</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a><span class="cf">while</span>(delta <span class="sc">&gt;</span> <span class="fl">1e-5</span>){</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  lambda[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span>  n<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">Econd</span>(lambda[i],u,v)) <span class="co"># M-step</span></span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  delta <span class="ot">=</span> <span class="fu">abs</span>(lambda[i<span class="sc">+</span><span class="dv">1</span>]<span class="sc">-</span>lambda[i])</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  i <span class="ot">=</span> i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>}</span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>lambdahat.EM <span class="ot">=</span> lambda[i]</span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(lambdahat,lambdahat.EM),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.07197 0.07197</code></pre>
</div>
<div id="question-2-7" class="section level3">
<h3>Question 2</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>B <span class="ot">&lt;-</span> A<span class="sc">+</span><span class="dv">2</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb98-24"><a href="#cb98-24" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb98-25"><a href="#cb98-25" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb98-26"><a href="#cb98-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb98-27"><a href="#cb98-27" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb98-28"><a href="#cb98-28" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb98-29"><a href="#cb98-29" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb98-30"><a href="#cb98-30" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-31"><a href="#cb98-31" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb98-32"><a href="#cb98-32" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb98-33"><a href="#cb98-33" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb98-34"><a href="#cb98-34" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb98-35"><a href="#cb98-35" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb98-36"><a href="#cb98-36" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb98-37"><a href="#cb98-37" tabindex="-1"></a>soln</span>
<span id="cb98-38"><a href="#cb98-38" tabindex="-1"></a>}</span>
<span id="cb98-39"><a href="#cb98-39" tabindex="-1"></a></span>
<span id="cb98-40"><a href="#cb98-40" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A)</span>
<span id="cb98-41"><a href="#cb98-41" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb98-42"><a href="#cb98-42" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s1<span class="sc">$</span>x, s2<span class="sc">$</span>x), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s1<span class="sc">$</span>v, s2<span class="sc">$</span>v), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##     [,1] [,2]
## x10    0    2</code></pre>
<p>It is obvious that both payoff matrix lead to the same optimal
strategy in game A and game B. But the values of both games are
different. From the property of simplex method in LP, the solution must
be one of the extreme points.</p>
</div>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="section" class="section level2">
<h2>2.1.3</h2>
<p><strong>Q4:</strong>Why do you need to use unlist() to convert a list
to an atomic vector? Why doesn’t as.vector() work?</p>
<p><strong>A:</strong>Note that list is also a vector but it is not a
atomic vector. Therefore, as.vector() doesn’t work for list. We use
unlist() to get rid of the nested structure.</p>
</div>
<div id="section-1" class="section level2">
<h2>2.3.1</h2>
<p><strong>Q1:</strong>What does dim() return when applied to a
vector?</p>
<p><strong>A:</strong>dim() will return NULL when applied to a 1d
vector.</p>
<p><strong>Q2:</strong>If is.matrix(x) is TRUE, what will is.array(x)
return?</p>
<p><strong>A:</strong>is.array(x) will return TRUE because a matrix is
also a two-dimensional array.</p>
</div>
<div id="section-2" class="section level2">
<h2>2.4.5</h2>
<p><strong>Q2:</strong>What does as.matrix() do when applied to a data
frame with columns of different types?</p>
<p><strong>A:</strong>From help documents of as.matrix(): The method for
data frames will return a character matrix if there is only atomic
columns and any non-(numeric/logical/complex) column, applying as.vector
to factors and format to other non-character columns. Otherwise, the
usual coercion hierarchy (logical &lt; integer &lt; double &lt; complex)
will be used.</p>
<p><strong>Q3:</strong>Can you have a data frame with 0 rows? What about
0 columns?</p>
<p><strong>A:</strong>Yes, here is an example:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="fu">c</span>())</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">nrow</span>(x);<span class="fu">ncol</span>(x)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="exercise-11.1.2" class="section level2">
<h2>Exercise 11.1.2</h2>
<p>lapply() can be used to apply the function to every colume of a data
frame. This function needs a numeric input, so if the colume isn’t
numeric, we can return it directly.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>}</span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="fu">lapply</span>(iris,<span class="cf">function</span>(x) <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x)))</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1   0.22222222   0.6250000   0.06779661  0.04166667  setosa
## 2   0.16666667   0.4166667   0.06779661  0.04166667  setosa
## 3   0.11111111   0.5000000   0.05084746  0.04166667  setosa
## 4   0.08333333   0.4583333   0.08474576  0.04166667  setosa
## 5   0.19444444   0.6666667   0.06779661  0.04166667  setosa
## 6   0.30555556   0.7916667   0.11864407  0.12500000  setosa</code></pre>
<p>If we only want to apply the function to numeric columes, we can use
sapply() first to extract the numeric columes.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">data.frame</span>(<span class="fu">lapply</span>(iris[<span class="fu">sapply</span>(iris,is.numeric)],scale01)))</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width
## 1   0.22222222   0.6250000   0.06779661  0.04166667
## 2   0.16666667   0.4166667   0.06779661  0.04166667
## 3   0.11111111   0.5000000   0.05084746  0.04166667
## 4   0.08333333   0.4583333   0.08474576  0.04166667
## 5   0.19444444   0.6666667   0.06779661  0.04166667
## 6   0.30555556   0.7916667   0.11864407  0.12500000</code></pre>
</div>
<div id="exercise-11.2.5" class="section level2">
<h2>Exercise 11.2.5</h2>
<p>For a numeric data frame:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">vapply</span>(cars, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     speed      dist 
##  5.287644 25.769377</code></pre>
<p>For a mixed data frame:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">vapply</span>(iris[<span class="fu">vapply</span>(iris, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],</span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>       sd, </span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>       <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
</div>
<div id="exercise-9.8" class="section level2">
<h2>Exercise 9.8</h2>
<p>This example appears in [40]. Consider the bivariate density f(x,
y),It can be shown (see e.g. [23]) that for fixed a, b, n, the
conditional distributions are Binomial(n, y) and Beta(x+ a, n − x+ b).
Use the Gibbs sampler to generate a chain with target joint density f(x,
y).</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&quot;../src/GibbsC.cpp&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork):
## path[1]=&quot;C:/Users/10475/Documents/SA23204180/src/../inst/include&quot;:
## 系统找不到指定的文件。</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a></span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>gibbs_sampler_r <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples, n, a, b) {</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> num_samples, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>  </span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb119-10"><a href="#cb119-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb119-11"><a href="#cb119-11" tabindex="-1"></a>  </span>
<span id="cb119-12"><a href="#cb119-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb119-13"><a href="#cb119-13" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb119-14"><a href="#cb119-14" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x <span class="sc">+</span> a, n <span class="sc">-</span> x <span class="sc">+</span> b)</span>
<span id="cb119-15"><a href="#cb119-15" tabindex="-1"></a>    </span>
<span id="cb119-16"><a href="#cb119-16" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb119-17"><a href="#cb119-17" tabindex="-1"></a>  }</span>
<span id="cb119-18"><a href="#cb119-18" tabindex="-1"></a>  </span>
<span id="cb119-19"><a href="#cb119-19" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb119-20"><a href="#cb119-20" tabindex="-1"></a>}</span>
<span id="cb119-21"><a href="#cb119-21" tabindex="-1"></a></span>
<span id="cb119-22"><a href="#cb119-22" tabindex="-1"></a>mb <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb119-23"><a href="#cb119-23" tabindex="-1"></a>  <span class="fu">gibbs_sampler_r</span>(num_samples, n, a, b),</span>
<span id="cb119-24"><a href="#cb119-24" tabindex="-1"></a>  <span class="fu">gibbsSampler</span>(num_samples, n, a, b),</span>
<span id="cb119-25"><a href="#cb119-25" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">100</span></span>
<span id="cb119-26"><a href="#cb119-26" tabindex="-1"></a>)</span>
<span id="cb119-27"><a href="#cb119-27" tabindex="-1"></a></span>
<span id="cb119-28"><a href="#cb119-28" tabindex="-1"></a><span class="fu">summary</span>(mb)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##                                    expr      lq  median      uq
## 1 gibbs_sampler_r(num_samples, n, a, b) 5586.65 6042.10 7206.55
## 2    gibbsSampler(num_samples, n, a, b)  297.80  435.25  485.00</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
